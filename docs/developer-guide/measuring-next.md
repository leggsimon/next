---
layout: default
title: Measuring Next
section: Developer guide
permalink: /docs/developer-guide/measuring-next/
---

# Measuring Next

## Events

Next uses a simple event model to describe information about usage and behaviour.

Every system in next - both client-side and server - can broacast events.

<img src="{{ site.baseurl }}/img/events.png" width="75%" />

Each event comprises of four models and an _event type_.

The type of event describes what happened - Eg, a _page view_, an _error_ etc. and the models describe the metadata about the event.

- The _User_ model describes information about who the event was generated by, essentially a real-life person with an FT account.
- The _Page_ model describes where the event happened, typically a webpage.
- The _Time_ model describes when the event happened.
- The _Meta_ model allows additional context to be associated with an event.

## Beacon

Events can be sent to the next Beacon API in [JSON form](https://gist.github.com/commuterjoy/4f69e0c55e8f1a4074a0).

The Beacon decorates the events with some additional information - some data
from the Content API, some [geographic
information](https://docs.fastly.com/guides/vcl-extensions/geoiprelated-vcl-features)
- and sends them on to our data store.

There's a couple of beacon clients to get started, 

- [frontend beacon client](https://github.com/Financial-Times/next-beacon-component). 
- [node.js beacon](https://github.com/Financial-Times/next-beacon).

## Analysis

Currently Next uses [Keen.io](http://keen.io) to store and analyse the events.

As the plans around our future reporting systems become clear we may move our
analysis in to RedShift and A.N.Other systems.

## Split testing

Next has a homebrewed AB testing framework built in to it's core.

The aim is to provide a much richer means of modifying the state of the application than a client-side JavaScript AB testing library.

1. Every request that comes in to Next is decorated by a flag indicating which tests a user belongs to. 
1. The application then serves each user a version of the site based on their flag state - i.e. the test variant or control.
1. The data we collect via the beacon includes the test flags, which can then be used in any analysis undertaken.

To read more about this :-

- Segmentation of users in to test groups is done by [next-ab](https://github.com/Financial-Times/next-ab).
- [Features flags API](https://github.com/Financial-Times/next-feature-flags-api) - allows people to wrap flags around features.
- [Features flags client](https://github.com/Financial-Times/next-feature-flags-client) - exposes the flags to applications. Note the middleware, which maps the incoming _x-flags_ header to a feature flag.
- [Data collection](https://github.com/Financial-Times/next-beacon) - _see above_.
- [keen.io analysis APIs](https://keen.io/docs/data-analysis/).

We keep a [discussion document of AB
tests](https://docs.google.com/a/ft.com/document/d/1Cp-_Ho5OSRr_vztS_SwFDGkt-eVvbQviTMqAMG8XZV8)
we want to run.

## iJento

Next maintains a [minimal implementation of iJento
tracking](https://github.com/Financial-Times/next-ijento) to service business
critical reporting.

